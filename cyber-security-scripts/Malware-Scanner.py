import os, glob, sys
def get_filename():
    cwd = sys.argv[0]
    cwd = list(cwd)
    result = ""
    for i in cwd:
        if i == "/" or i == '\\':
            result = result + " "
        else:
            result = result + i
    result = result.split()
    final_result = result[(len(result) -  1)]
    return final_result
filename = get_filename()
def asktodelete(script):
    global script_file
    script_file.close()
    delete = input("[+] Delete File?: ")
    if delete.lower() == "yes":
        print(f"[+] Deleting File: {script}")
        os.remove(script)
    elif delete.lower() == "no":
        print("[+] This action may comprimise your Computer.")
        pass
    else:
        print(f"[+] Deleted File: {script}")
        os.remove(script)
print("  __  __       _                           _____                                   __   ___  ")
print(" |  \/  |     | |                         / ____|                                 /_ | / _ \ ")
print(" | \  / | __ _| |_      ____ _ _ __ ___  | (___   ___ __ _ _ __  _ __   ___ _ __   | || | | |")
print(" | |\/| |/ _` | \ \ /\ / / _` | '__/ _ \  \___ \ / __/ _` | '_ \| '_ \ / _ \ '__|  | || | | |")
print(" | |  | | (_| | |\ V  V / (_| | | |  __/  ____) | (_| (_| | | | | | | |  __/ |     | || |_| |")
print(" |_|  |_|\__,_|_| \_/\_/ \__,_|_|  \___| |_____/ \___\__,_|_| |_|_| |_|\___|_|     |_(_)___/ ")
print("")
print(" Script By DrSquid")
print(" This script can scan for malware in python files.")
while True:
    try:
        directory = input("\n[+] Enter the Directory to scan files in: ")
        os.chdir(directory)
        pyscripts = glob.glob('*.py') + glob.glob('*.pyw')
        for script in pyscripts:
            try:
                script_file = open(script, 'r')
                lines = script_file.readlines()
                for line in lines:
                    if 'os.remove' in line.lower() or 'os.rmdir' in line.lower():
                        if script == filename:
                            pass
                        else:
                            print(f"\n[+] File {script} has triggered Alert: Trojan:FileDel")
                            print("[+] This file can delete certain files on your computer.")
                            asktodelete(script)
                            break
                    elif 'connect(' in line.lower() or 'sento(' in line.lower() or 'send' in line.lower():
                        if script == filename:
                            pass
                        else:
                            print(f"\n[+] Script: {script} Has Triggered Alert: Trojan:SockDDoS")
                            print("[+] This script can potentially be used in a DDoS Attack.")
                            asktodelete(script)
                            break
                    elif 'os.system' in line.lower():
                        if script == filename:
                            pass
                        else:
                            print(f"\n[+] Script: {script} Has Triggered Alert: Trojan:Term")
                            print("[+] This script can run Terminal Commands.")
                            asktodelete(script)
                            break
                    elif 'os.startfile' in line.lower():
                        if script == filename:
                            pass
                        else:
                            print(f"\n[+] Script: {script} Has Triggered Alert: Trojan:LagCPU")
                            print(
                                "[+] This file can start up other files and could potentially slow down the computer.")
                            asktodelete(script)
                            break
                    elif 'open(' in line.lower():
                        if script == filename:
                            pass
                        else:
                            print(f"\n[+] Script: {script} Has Triggered Alert: Trojan:ReadWriteFiles")
                            print("[+] This file can read and write other files and possibly make other files malicious without you knowing.")
                            asktodelete(script)
                            break
                    elif 'never gonna give you up' in line.lower():
                        if script == filename:
                            pass
                        else:
                            print(f"\n[+] Script: {script} Has Triggered Alert: Trojan:RickRoll")
                            print("[+] This file might be a rick roll.")
                            asktodelete(script)
                            break
                    elif 'copyfile(' in line.lower():
                        if script == filename:
                            pass
                        else:
                            print(f"\n[+] Script: {script} Has Triggered Alert: Worm:SelfReplicating")
                            print("[+] This file can clone itself into other directories in your computer.")
                            asktodelete(script)
                            break
            except:
                pass
        print("\n[+] Scan Completed.")
    except:
        print("[+] Invalid Input.")
